# è·¯ç”±åˆ é™¤åŠŸèƒ½

## æ¦‚è¿°

æ–°å¢äº†åˆ é™¤å•ä¸€è·¯ç”±æ–‡ä»¶å¤¹çš„åŠŸèƒ½ï¼Œå…è®¸ç”¨æˆ·åœ¨é¢„è§ˆç•Œé¢ä¸­ç›´æ¥åˆ é™¤ä¸éœ€è¦çš„è·¯ç”±é¡µé¢ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

### ğŸ—‘ï¸ **å®‰å…¨åˆ é™¤**

- **è·¯å¾„éªŒè¯**ï¼šç¡®ä¿åªèƒ½åˆ é™¤ sandbox ç›®å½•å†…çš„æ–‡ä»¶
- **ä¿æŠ¤æœºåˆ¶**ï¼šé˜²æ­¢åˆ é™¤é‡è¦æ–‡ä»¶ï¼ˆå¦‚ layout.tsxã€page.tsx ç­‰ï¼‰
- **ç¡®è®¤å¯¹è¯æ¡†**ï¼šåˆ é™¤å‰éœ€è¦ç”¨æˆ·ç¡®è®¤æ“ä½œ

### ğŸ¯ **æ™ºèƒ½é™åˆ¶**

- **é¦–é¡µä¿æŠ¤**ï¼šä¸èƒ½åˆ é™¤é¦–é¡µè·¯ç”±ï¼ˆ`/`ï¼‰
- **ç›®å½•é™åˆ¶**ï¼šåªèƒ½åˆ é™¤ `app/` ç›®å½•ä¸‹çš„å­ç›®å½•
- **é€’å½’åˆ é™¤**ï¼šåˆ é™¤æ•´ä¸ªè·¯ç”±æ–‡ä»¶å¤¹åŠå…¶æ‰€æœ‰å†…å®¹

### ğŸ”„ **å®æ—¶æ›´æ–°**

- **è·¯ç”±åˆ—è¡¨åˆ·æ–°**ï¼šåˆ é™¤åè‡ªåŠ¨æ›´æ–°è·¯ç”±åˆ—è¡¨
- **è‡ªåŠ¨åˆ‡æ¢**ï¼šåˆ é™¤å½“å‰è·¯ç”±åè‡ªåŠ¨åˆ‡æ¢åˆ°é¦–é¡µ
- **çŠ¶æ€åŒæ­¥**ï¼šåˆ é™¤æ“ä½œç«‹å³åæ˜ åœ¨ç•Œé¢ä¸Š

## ä½¿ç”¨æ–¹æ³•

### 1. åœ¨é¢„è§ˆç•Œé¢åˆ é™¤

1. è®¿é—®é¢„è§ˆé¡µé¢ï¼š`http://localhost:3000/preview/sandbox-project`
2. åœ¨è·¯ç”±é€‰æ‹©å™¨ä¸­é€‰æ‹©è¦åˆ é™¤çš„è·¯ç”±
3. ç‚¹å‡»çº¢è‰²çš„"åˆ é™¤"æŒ‰é’®
4. ç¡®è®¤åˆ é™¤æ“ä½œ

### 2. é€šè¿‡ API åˆ é™¤

```bash
# åˆ é™¤æŒ‡å®šè·¯ç”±
curl -X DELETE "http://localhost:3000/api/sandbox/files?path=app/RouteName" \
  -H "Content-Type: application/json"
```

## API æ¥å£

### DELETE /api/sandbox/files

**å‚æ•°ï¼š**

- `path` (query): è¦åˆ é™¤çš„è·¯ç”±è·¯å¾„ï¼Œä¾‹å¦‚ `app/BeautyHero`

**å“åº”ç¤ºä¾‹ï¼š**

```json
{
  "success": true,
  "message": "Route directory deleted successfully: app/BeautyHero",
  "deletedPath": "app/BeautyHero"
}
```

**é”™è¯¯å“åº”ï¼š**

```json
{
  "success": false,
  "error": "Route directory not found"
}
```

## å®‰å…¨é™åˆ¶

### å—ä¿æŠ¤çš„æ–‡ä»¶/ç›®å½•

- `package.json`
- `next.config.ts`
- `tailwind.config.js`
- `tsconfig.json`
- `app/layout.tsx`
- `app/page.tsx`
- `app/globals.css`

### åˆ é™¤é™åˆ¶

- âŒ ä¸èƒ½åˆ é™¤é¦–é¡µè·¯ç”±ï¼ˆ`/`ï¼‰
- âŒ ä¸èƒ½åˆ é™¤ `app` æ ¹ç›®å½•
- âŒ ä¸èƒ½åˆ é™¤å—ä¿æŠ¤çš„æ–‡ä»¶
- âœ… å¯ä»¥åˆ é™¤ `app/` ä¸‹çš„å­ç›®å½•ï¼ˆå¦‚ `app/BeautyHero`ï¼‰

## ç•Œé¢è®¾è®¡

### åˆ é™¤æŒ‰é’®æ ·å¼

- **ä½ç½®**ï¼šè·¯ç”±é€‰æ‹©å™¨å³ä¾§
- **é¢œè‰²**ï¼šçº¢è‰²ä¸»é¢˜ï¼ˆ`bg-red-50`ã€`text-red-600`ï¼‰
- **å›¾æ ‡**ï¼šğŸ—‘ï¸ åƒåœ¾æ¡¶å›¾æ ‡
- **çŠ¶æ€**ï¼šåªåœ¨éé¦–é¡µè·¯ç”±æ—¶æ˜¾ç¤º

### ç”¨æˆ·ä½“éªŒ

- **ç¡®è®¤å¯¹è¯æ¡†**ï¼šæ˜¾ç¤ºè·¯ç”±åç§°å’Œè·¯å¾„
- **å³æ—¶åé¦ˆ**ï¼šåˆ é™¤æˆåŠŸåæ˜¾ç¤ºæç¤ºä¿¡æ¯
- **è‡ªåŠ¨åˆ‡æ¢**ï¼šåˆ é™¤å½“å‰è·¯ç”±åè‡ªåŠ¨åˆ‡æ¢åˆ°é¦–é¡µ
- **é”™è¯¯å¤„ç†**ï¼šæ˜¾ç¤ºå…·ä½“çš„é”™è¯¯ä¿¡æ¯

## æŠ€æœ¯å®ç°

### åç«¯å®ç°

```typescript
// é€’å½’åˆ é™¤ç›®å½•
async function removeDirectoryRecursive(dirPath: string): Promise<void> {
  const entries = await fs.readdir(dirPath, { withFileTypes: true });

  for (const entry of entries) {
    const fullPath = path.join(dirPath, entry.name);
    if (entry.isDirectory()) {
      await removeDirectoryRecursive(fullPath);
    } else {
      await fs.unlink(fullPath);
    }
  }

  await fs.rmdir(dirPath);
}
```

### å‰ç«¯å®ç°

```typescript
const handleDeleteRoute = async (route: RouteInfo) => {
  // ç¡®è®¤åˆ é™¤
  if (!confirm(`ç¡®å®šè¦åˆ é™¤è·¯ç”± "${route.name}" å—ï¼Ÿ`)) {
    return;
  }

  // ä» filePath ä¸­æå–ç›®å½•è·¯å¾„
  // ä¾‹å¦‚ï¼šä» "TechHero/page.tsx" æå– "app/TechHero"
  const directoryPath = `app/${route.filePath.split("/")[0]}`;

  // è°ƒç”¨åˆ é™¤ API
  const response = await fetch(`/api/sandbox/files?path=${directoryPath}`, {
    method: "DELETE",
  });

  // æ›´æ–°è·¯ç”±åˆ—è¡¨
  if (response.ok) {
    await loadRoutes();
  }
};
```

### è·¯å¾„è½¬æ¢é€»è¾‘

è·¯ç”±æ£€æµ‹ API è¿”å›çš„ `filePath` æ ¼å¼ä¸åˆ é™¤ API éœ€è¦çš„è·¯å¾„æ ¼å¼ä¸åŒï¼š

- **è·¯ç”±æ£€æµ‹ API è¿”å›**ï¼š`"TechHero/page.tsx"` æˆ– `"xxx/yyy/page.tsx"`
- **åˆ é™¤ API éœ€è¦**ï¼š`"app/TechHero"` æˆ– `"app/xxx/yyy"`

å› æ­¤éœ€è¦åœ¨å‰ç«¯è¿›è¡Œè·¯å¾„è½¬æ¢ï¼Œæ”¯æŒåµŒå¥—è·¯ç”±ï¼š

```typescript
// æ”¯æŒåµŒå¥—è·¯ç”±çš„è·¯å¾„è½¬æ¢
const pathParts = route.filePath.split("/");
const directoryName = pathParts.slice(0, -1).join("/"); // ç§»é™¤æœ€åçš„ "page.tsx"
const directoryPath = `app/${directoryName}`;
```

### æ”¯æŒçš„åˆ é™¤åœºæ™¯

- âœ… **ä¸€çº§è·¯ç”±**ï¼š`app/BeautyHero` â†’ åˆ é™¤æ•´ä¸ª BeautyHero ç›®å½•
- âœ… **åµŒå¥—è·¯ç”±**ï¼š`app/xxx/yyy` â†’ åˆ é™¤æ•´ä¸ª yyy ç›®å½•
- âœ… **æ·±å±‚åµŒå¥—**ï¼š`app/a/b/c` â†’ åˆ é™¤æ•´ä¸ª c ç›®å½•
- âœ… **è‡ªåŠ¨æ¸…ç†ç©ºç›®å½•**ï¼šåˆ é™¤åè‡ªåŠ¨åˆ é™¤ç©ºçš„çˆ¶çº§ç›®å½•

### è‡ªåŠ¨æ¸…ç†ç©ºç›®å½•åŠŸèƒ½

å½“åˆ é™¤åµŒå¥—è·¯ç”±æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æŸ¥å¹¶åˆ é™¤ç©ºçš„çˆ¶çº§ç›®å½•ï¼š

**ç¤ºä¾‹åœºæ™¯**ï¼š

```
app/test/nested/deep/page.tsx
```

åˆ é™¤ `app/test/nested/deep` åï¼š

1. åˆ é™¤ `deep` ç›®å½•åŠå…¶å†…å®¹
2. æ£€æŸ¥ `nested` ç›®å½•æ˜¯å¦ä¸ºç©º â†’ ä¸ºç©ºï¼Œåˆ é™¤
3. æ£€æŸ¥ `test` ç›®å½•æ˜¯å¦ä¸ºç©º â†’ ä¸ºç©ºï¼Œåˆ é™¤
4. æ£€æŸ¥ `app` ç›®å½• â†’ ä¸ä¸ºç©ºï¼Œåœæ­¢åˆ é™¤

**API å“åº”ç¤ºä¾‹**ï¼š

```json
{
  "success": true,
  "message": "Route directory deleted successfully: app/test/nested/deep",
  "deletedPath": "app/test/nested/deep",
  "removedParentDirs": ["app/test/nested", "app/test"]
}
```

## æ³¨æ„äº‹é¡¹

1. **å¤‡ä»½é‡è¦æ•°æ®**ï¼šåˆ é™¤æ“ä½œä¸å¯é€†ï¼Œè¯·ç¡®ä¿é‡è¦æ•°æ®å·²å¤‡ä»½
2. **ä¾èµ–å…³ç³»**ï¼šåˆ é™¤è·¯ç”±å‰è¯·æ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–ç»„ä»¶ä¾èµ–è¯¥è·¯ç”±
3. **æµ‹è¯•ç¯å¢ƒ**ï¼šå»ºè®®åœ¨æµ‹è¯•ç¯å¢ƒä¸­å…ˆéªŒè¯åˆ é™¤åŠŸèƒ½
4. **æƒé™æ§åˆ¶**ï¼šç¡®ä¿åªæœ‰æˆæƒç”¨æˆ·å¯ä»¥æ‰§è¡Œåˆ é™¤æ“ä½œ

## æœªæ¥æ‰©å±•

- [ ] æ‰¹é‡åˆ é™¤å¤šä¸ªè·¯ç”±
- [ ] åˆ é™¤å‰æ£€æŸ¥ä¾èµ–å…³ç³»
- [ ] åˆ é™¤å†å²è®°å½•å’Œæ¢å¤åŠŸèƒ½
- [ ] æ›´ç»†ç²’åº¦çš„æƒé™æ§åˆ¶
