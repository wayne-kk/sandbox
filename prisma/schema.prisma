// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

// 项目文件 - 独立的项目文件管理，不依赖用户
model ProjectFile {
  id        String   @id @default(cuid())
  projectId String   // 项目ID，现在是独立的标识符
  filePath  String   // 文件路径，如 "src/App.tsx"
  content   String   // 文件内容
  size      Int      @default(0) // 文件大小（字节）
  language  String?  // 文件语言类型
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("project_files")
  @@unique([projectId, filePath]) // 同一个项目中文件路径唯一
  @@index([projectId])
}

// 模板定义 - 系统预设的模板
model Template {
  id          String   @id @default(cuid())
  name        String   @unique // 模板名称，如 "react-basic", "vue-starter"
  displayName String   // 显示名称，如 "React 基础模板"
  description String?  // 模板描述
  framework   String   // 框架类型
  isActive    Boolean  @default(true) // 是否启用
  sortOrder   Int      @default(0) // 排序
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // 模板文件
  files TemplateFile[]

  @@map("templates")
}

// 模板文件
model TemplateFile {
  id         String   @id @default(cuid())
  templateId String
  filePath   String   // 文件路径
  content    String   // 文件内容
  isReadonly Boolean  @default(false) // 是否只读
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  template Template @relation(fields: [templateId], references: [id], onDelete: Cascade)

  @@map("template_files")
  @@unique([templateId, filePath])
  @@index([templateId])
} 