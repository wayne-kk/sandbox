# V0-Sandbox é¡¹ç›®è¯¦ç»†è¯´æ˜æ–‡æ¡£

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

V0-Sandbox æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„åœ¨çº¿ä»£ç ç¼–è¾‘å™¨å’Œå¼€å‘ç¯å¢ƒï¼Œä¸“æ³¨äº React/Next.js é¡¹ç›®çš„å¿«é€ŸåŸå‹å¼€å‘å’Œ AI è¾…åŠ©ä»£ç ç”Ÿæˆã€‚å®ƒæä¾›äº†å®Œæ•´çš„ IDE ä½“éªŒï¼ŒåŒ…æ‹¬ä»£ç ç¼–è¾‘ã€å®æ—¶é¢„è§ˆã€Docker å®¹å™¨åŒ–è¿è¡Œç¯å¢ƒï¼Œä»¥åŠåŸºäº Dify çš„ AI ä»£ç ç”ŸæˆåŠŸèƒ½ã€‚

### æ ¸å¿ƒç‰¹æ€§

- ğŸ¨ **Monaco ç¼–è¾‘å™¨**ï¼šåŸºäº VS Code çš„å¼ºå¤§ä»£ç ç¼–è¾‘ä½“éªŒ
- ğŸ“ **æ–‡ä»¶ç®¡ç†**ï¼šæ”¯æŒå¤šæ–‡ä»¶ç¼–è¾‘å’Œé¡¹ç›®ç»“æ„ç®¡ç†
- ğŸ³ **Docker æ²™ç®±**ï¼šå®‰å…¨éš”ç¦»çš„é¡¹ç›®è¿è¡Œç¯å¢ƒ
- âš¡ **å®æ—¶é¢„è§ˆ**ï¼šå³æ—¶æŸ¥çœ‹é¡¹ç›®è¿è¡Œç»“æœ
- ğŸ’¾ **è‡ªåŠ¨ä¿å­˜**ï¼šç¼–è¾‘æ—¶è‡ªåŠ¨ä¿å­˜æ–‡ä»¶
- ğŸ¤– **AI ä»£ç ç”Ÿæˆ**ï¼šé›†æˆ Dify AI è¿›è¡Œæ™ºèƒ½ä»£ç ç”Ÿæˆ
- ğŸ”„ **çƒ­é‡è½½**ï¼šæ–‡ä»¶ä¿®æ”¹åè‡ªåŠ¨é‡æ–°åŠ è½½
- ğŸ“¥ **GitHub å¯¼å…¥**ï¼šæ”¯æŒä» GitHub ä»“åº“ç›´æ¥å¯¼å…¥é¡¹ç›®
- ğŸ–¥ï¸ **å¢å¼ºç»ˆç«¯**ï¼šæ”¯æŒå‘½ä»¤æ‰§è¡Œå’Œè¿›ç¨‹ç®¡ç†

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### å‰ç«¯æŠ€æœ¯æ ˆ

- **Next.js 15.3.3**ï¼šReact å…¨æ ˆæ¡†æ¶
- **React 18**ï¼šç”¨æˆ·ç•Œé¢åº“
- **TypeScript**ï¼šç±»å‹å®‰å…¨çš„ JavaScript
- **Tailwind CSS**ï¼šæ ·å¼æ¡†æ¶
- **Monaco Editor**ï¼šä»£ç ç¼–è¾‘å™¨
- **Lucide React**ï¼šå›¾æ ‡åº“
- **Radix UI**ï¼šæ— éšœç¢ UI ç»„ä»¶

### åç«¯æŠ€æœ¯æ ˆ

- **Node.js 18**ï¼šæœåŠ¡å™¨è¿è¡Œæ—¶
- **Docker**ï¼šå®¹å™¨åŒ–è¿è¡Œç¯å¢ƒ
- **Prisma**ï¼šæ•°æ®åº“ ORM
- **SQLite**ï¼šæ•°æ®åº“
- **WebSocket**ï¼šå®æ—¶é€šä¿¡

### AI é›†æˆ

- **Dify å¹³å°**ï¼šAI å·¥ä½œæµç®¡ç†
- **ç»„ä»¶åˆ†æå™¨**ï¼šè‡ªåŠ¨åˆ†æé¡¹ç›®ç»„ä»¶åº“
- **æ™ºèƒ½ä¸Šä¸‹æ–‡æ„å»º**ï¼šä¸º AI æä¾›é¡¹ç›®ä¸Šä¸‹æ–‡

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### 1. é›†æˆå¼€å‘ç¯å¢ƒ (IDE)

#### æ–‡ä»¶ç®¡ç†å™¨

- **è·¯å¾„**: `src/components/IDE/IntegratedIDE.tsx`
- **åŠŸèƒ½**:
  - æ ‘çŠ¶æ–‡ä»¶æµè§ˆå™¨
  - å¤šæ ‡ç­¾æ–‡ä»¶ç¼–è¾‘
  - æ–‡ä»¶æ–°å»º/åˆ é™¤/é‡å‘½å
  - é¡¹ç›®æ–‡ä»¶è‡ªåŠ¨åŠ è½½

#### ä»£ç ç¼–è¾‘å™¨

- **åŸºäº**: Monaco Editor
- **ç‰¹æ€§**:
  - è¯­æ³•é«˜äº®
  - æ™ºèƒ½æç¤º
  - é”™è¯¯æ£€æµ‹
  - ä»£ç æ ¼å¼åŒ–
  - å¤šè¯­è¨€æ”¯æŒ (TypeScript, JavaScript, CSS, JSON, Markdown)

#### å®æ—¶é¢„è§ˆ

- **æœºåˆ¶**: iframe åµŒå…¥
- **åŠŸèƒ½**:
  - å®æ—¶çƒ­é‡è½½
  - å¤šç«¯å£è‡ªåŠ¨åˆ†é…
  - é”™è¯¯çŠ¶æ€æ˜¾ç¤º
  - é¢„è§ˆé“¾æ¥ç”Ÿæˆ

### 2. å®¹å™¨åŒ–è¿è¡Œç¯å¢ƒ

#### Docker ç®¡ç†å™¨

- **è·¯å¾„**: `src/lib/docker.ts`
- **åŠŸèƒ½**:
  - å®¹å™¨åˆ›å»ºå’Œç®¡ç†
  - é•œåƒæ„å»ºå’Œæ‹‰å–
  - è¿›ç¨‹ç›‘æ§å’Œæ§åˆ¶
  - èµ„æºæ¸…ç†

#### é¡¹ç›®ç®¡ç†å™¨

- **è·¯å¾„**: `src/lib/project-manager.ts`
- **åŠŸèƒ½**:
  - é¡¹ç›®ç”Ÿå‘½å‘¨æœŸç®¡ç†
  - ç«¯å£è‡ªåŠ¨åˆ†é… (3100-3199)
  - ä¾èµ–å®‰è£…
  - æ„å»ºæ—¥å¿—ç®¡ç†
  - WebSocket çŠ¶æ€åŒæ­¥

### 3. AI ä»£ç ç”Ÿæˆç³»ç»Ÿ

#### Dify å®¢æˆ·ç«¯

- **è·¯å¾„**: `src/lib/ai/dify-client.ts`
- **åŠŸèƒ½**:
  - ä¸ Dify API é€šä¿¡
  - ç»„ä»¶ä¸Šä¸‹æ–‡åˆ†æ
  - ä»£ç ç”Ÿæˆå’Œè§£æ
  - ä¼šè¯ç®¡ç†

#### ç»„ä»¶åˆ†æå™¨

- **è·¯å¾„**: `src/lib/ai/component-analyzer.ts`
- **åŠŸèƒ½**:
  - è‡ªåŠ¨åˆ†æ shadcn/ui ç»„ä»¶
  - ç”Ÿæˆç»„ä»¶æ–‡æ¡£
  - æå– Props å’Œå˜ä½“ä¿¡æ¯
  - ä¸º AI æä¾›ç»„ä»¶ä¸Šä¸‹æ–‡

#### æ™ºèƒ½ä¸Šä¸‹æ–‡æ„å»ºå™¨

- **è·¯å¾„**: `src/lib/ai/smart-context-builder.ts`
- **åŠŸèƒ½**:
  - é¡¹ç›®ç»“æ„åˆ†æ
  - ä¾èµ–å…³ç³»æ˜ å°„
  - è®¾è®¡ç³»ç»Ÿæ–‡æ¡£ç”Ÿæˆ
  - å¼€å‘çº¦å®šæå–

### 4. å¢å¼ºç»ˆç«¯

#### ç»ˆç«¯ç»„ä»¶

- **è·¯å¾„**: `src/components/Terminal/EnhancedTerminal.tsx`
- **åŠŸèƒ½**:
  - å®æ—¶å‘½ä»¤æ‰§è¡Œ
  - å‘½ä»¤å†å²å’Œè‡ªåŠ¨è¡¥å…¨
  - è¿›ç¨‹ç®¡ç†
  - SSE æµå¼è¾“å‡º
  - å¿«æ·é”®æ”¯æŒ

#### API è·¯ç”±

- **è·¯å¾„**: `src/app/api/terminal/route.ts`
- **åŠŸèƒ½**:
  - å‘½ä»¤æ‰§è¡Œ
  - è¿›ç¨‹ç›‘æ§
  - å®¹å™¨ç®¡ç†
  - çŠ¶æ€æ£€æŸ¥

## ğŸ”Œ API æ¥å£è®¾è®¡

### 1. é¡¹ç›®ç®¡ç† API

#### å¯åŠ¨é¡¹ç›®

```http
POST /api/project
{
  "action": "start",
  "projectId": "sandbox-project",
  "framework": "nextjs"
}
```

#### åœæ­¢é¡¹ç›®

```http
POST /api/project
{
  "action": "stop",
  "projectId": "sandbox-project"
}
```

#### æ›´æ–°æ–‡ä»¶

```http
POST /api/project
{
  "action": "update",
  "projectId": "sandbox-project",
  "files": {
    "src/App.tsx": "æ–‡ä»¶å†…å®¹..."
  }
}
```

### 2. AI ç”Ÿæˆ API

#### ç”Ÿæˆ UI ç»„ä»¶

```http
POST /api/ai/generate
{
  "prompt": "åˆ›å»ºä¸€ä¸ªç™»å½•é¡µé¢",
  "projectType": "nextjs",
  "projectId": "sandbox-project"
}
```

#### é…ç½®æ£€æŸ¥

```http
GET /api/ai/config-check
```

### 3. æ²™ç®±ç®¡ç† API

#### è¿è¡Œé¡¹ç›®

```http
POST /api/sandbox/run
{
  "type": "nextjs"
}
```

#### ä¿å­˜æ–‡ä»¶

```http
POST /api/sandbox/files
{
  "files": {
    "src/App.tsx": "æ–‡ä»¶å†…å®¹..."
  }
}
```

#### é‡ç½®æ²™ç®±

```http
POST /api/sandbox/reset
{
  "confirmReset": true
}
```

### 4. GitHub é›†æˆ API

#### ä¸‹è½½é¡¹ç›®

```http
POST /api/github/download
{
  "url": "https://github.com/user/repo",
  "branch": "main"
}
```

## ğŸ¨ ç”¨æˆ·ç•Œé¢è®¾è®¡

### 1. ä¸»ç•Œé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸš€ V0 Sandbox - é¡¶éƒ¨å¯¼èˆªæ                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ä»£ç ç¼–è¾‘å™¨] [å®æ—¶é¢„è§ˆ] [ç»ˆç«¯] - æ ‡ç­¾é¡µ                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ–‡ä»¶æµè§ˆå™¨    â”‚ ä¸»ç¼–è¾‘åŒºåŸŸ                                  â”‚
â”‚ ğŸ“ src/      â”‚ Monaco ç¼–è¾‘å™¨ / é¢„è§ˆ iframe / ç»ˆç«¯         â”‚
â”‚ ğŸ“„ App.tsx   â”‚                                          â”‚
â”‚ ğŸ“„ index.css â”‚                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ çŠ¶æ€æ  - é¡¹ç›®çŠ¶æ€ã€æ–‡ä»¶ä¿¡æ¯ã€å¿«æ·é”®æç¤º                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. AI ç”Ÿæˆå™¨ç•Œé¢

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¤– AI ç»„ä»¶ç”Ÿæˆå™¨                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æè¿°è¾“å…¥æ¡†: "åˆ›å»ºä¸€ä¸ªç”¨æˆ·ç™»å½•é¡µé¢..."                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [å¿«é€Ÿç¤ºä¾‹] ç™»å½•é¡µé¢ | æ•°æ®ä»ªè¡¨æ¿ | åšå®¢å¡ç‰‡                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è¿›åº¦æ¡: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 80% æ­£åœ¨ç”Ÿæˆä»£ç ...                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç”Ÿæˆæ—¥å¿—:                                                 â”‚
â”‚ [æ—¶é—´] ğŸ¤– å¼€å§‹ AI ä»£ç ç”Ÿæˆ...                              â”‚
â”‚ [æ—¶é—´] ğŸ“š æ­£åœ¨åˆ†æç»„ä»¶åº“...                                â”‚
â”‚ [æ—¶é—´] âœ… ç”Ÿæˆå®Œæˆï¼å…±ç”Ÿæˆ 3 ä¸ªæ–‡ä»¶                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç»“æœæ‘˜è¦: 3 ä¸ªæ–‡ä»¶ | 8 ä¸ªåŠŸèƒ½ | 2 ä¸ªä¾èµ–                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š æ•°æ®åº“è®¾è®¡

### é¡¹ç›®æ–‡ä»¶è¡¨ (ProjectFile)

```sql
CREATE TABLE project_files (
  id TEXT PRIMARY KEY,
  projectId TEXT NOT NULL,
  filePath TEXT NOT NULL,
  content TEXT NOT NULL,
  size INTEGER DEFAULT 0,
  language TEXT,
  createdAt DATETIME DEFAULT CURRENT_TIMESTAMP,
  updatedAt DATETIME DEFAULT CURRENT_TIMESTAMP,
  UNIQUE(projectId, filePath)
);
```

### æ¨¡æ¿è¡¨ (Template)

```sql
CREATE TABLE templates (
  id TEXT PRIMARY KEY,
  name TEXT UNIQUE NOT NULL,
  displayName TEXT NOT NULL,
  description TEXT,
  framework TEXT NOT NULL,
  isActive BOOLEAN DEFAULT TRUE,
  sortOrder INTEGER DEFAULT 0,
  createdAt DATETIME DEFAULT CURRENT_TIMESTAMP,
  updatedAt DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

### æ¨¡æ¿æ–‡ä»¶è¡¨ (TemplateFile)

```sql
CREATE TABLE template_files (
  id TEXT PRIMARY KEY,
  templateId TEXT NOT NULL,
  filePath TEXT NOT NULL,
  content TEXT NOT NULL,
  isReadonly BOOLEAN DEFAULT FALSE,
  createdAt DATETIME DEFAULT CURRENT_TIMESTAMP,
  updatedAt DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (templateId) REFERENCES templates(id) ON DELETE CASCADE,
  UNIQUE(templateId, filePath)
);
```

## âš™ï¸ é…ç½®æ–‡ä»¶è¯´æ˜

### ç¯å¢ƒå˜é‡é…ç½®

```bash
# AI é›†æˆé…ç½®
DIFY_API_ENDPOINT=your_dify_api_endpoint
COMPONENT_DIFY_API_KEY=your_component_api_key
REQUIREMENT_DIFY_API_KEY=your_requirement_api_key

# åº”ç”¨é…ç½®
NEXT_PUBLIC_BASE_URL=http://localhost:3000

# æ•°æ®åº“é…ç½® (Prisma)
DATABASE_URL="file:./dev.db"
```

### Next.js é…ç½®

```javascript
// next.config.ts
const nextConfig = {
  experimental: {
    serverComponentsExternalPackages: ["prisma"],
  },
};
```

### Tailwind é…ç½®

```javascript
// tailwind.config.js
module.exports = {
  content: [
    "./src/**/*.{js,ts,jsx,tsx,mdx}",
    "./sandbox/**/*.{js,ts,jsx,tsx,mdx}",
  ],
  theme: {
    extend: {},
  },
  plugins: [],
};
```

## ğŸ”„ å·¥ä½œæµç¨‹

### 1. é¡¹ç›®å¯åŠ¨æµç¨‹

```mermaid
graph TD
    A[ç”¨æˆ·è®¿é—®é¦–é¡µ] --> B[åŠ è½½ IntegratedIDE ç»„ä»¶]
    B --> C[åˆå§‹åŒ–æ–‡ä»¶ç³»ç»Ÿ]
    C --> D[å»ºç«‹ WebSocket è¿æ¥]
    D --> E[åŠ è½½ sandbox æ–‡ä»¶]
    E --> F[Monaco ç¼–è¾‘å™¨å°±ç»ª]
    F --> G[ç”¨æˆ·å¯ä»¥å¼€å§‹ç¼–è¾‘]

    G --> H[ç”¨æˆ·ç‚¹å‡»è¿è¡Œé¡¹ç›®]
    H --> I[ProjectManager.startProject]
    I --> J[æŸ¥æ‰¾å¯ç”¨ç«¯å£]
    J --> K[æ›´æ–° package.json ç«¯å£]
    K --> L[å¯åŠ¨ npm run dev]
    L --> M[ç›‘å¬è¿›ç¨‹è¾“å‡º]
    M --> N[æ£€æµ‹æœåŠ¡å™¨å¯åŠ¨]
    N --> O[æ›´æ–°é¡¹ç›®çŠ¶æ€ä¸º running]
    O --> P[æ¨é€ WebSocket çŠ¶æ€æ›´æ–°]
    P --> Q[å‰ç«¯æ˜¾ç¤ºé¢„è§ˆ URL]
```

### 2. AI ä»£ç ç”Ÿæˆæµç¨‹

```mermaid
graph TD
    A[ç”¨æˆ·è¾“å…¥æç¤ºè¯] --> B[DifyUIGenerator ç»„ä»¶]
    B --> C[è°ƒç”¨ /api/ai/generate]
    C --> D[ComponentAnalyzer åˆ†æç»„ä»¶åº“]
    D --> E[SmartContextBuilder æ„å»ºä¸Šä¸‹æ–‡]
    E --> F[DifyClient è°ƒç”¨ AI API]
    F --> G[è§£æ AI å“åº”]
    G --> H[éªŒè¯ç”Ÿæˆçš„æ–‡ä»¶]
    H --> I[ProjectManager.saveProjectFiles]
    I --> J[å†™å…¥ sandbox ç›®å½•]
    J --> K[è§¦å‘çƒ­é‡è½½]
    K --> L[å‰ç«¯æ˜¾ç¤ºç”Ÿæˆç»“æœ]
```

### 3. æ–‡ä»¶ä¿å­˜å’ŒåŒæ­¥æµç¨‹

```mermaid
graph TD
    A[ç”¨æˆ·ç¼–è¾‘æ–‡ä»¶] --> B[Monaco onChange äº‹ä»¶]
    B --> C[updateFileContent æ›´æ–°çŠ¶æ€]
    C --> D[æ ‡è®°æ–‡ä»¶ä¸º dirty]
    D --> E[è‡ªåŠ¨ä¿å­˜å®šæ—¶å™¨è§¦å‘]
    E --> F[è°ƒç”¨ /api/project update]
    F --> G[ProjectManager.saveProjectFiles]
    G --> H[å†™å…¥æ–‡ä»¶ç³»ç»Ÿ]
    H --> I[é¡¹ç›®çƒ­é‡è½½]
    I --> J[WebSocket æ¨é€æ›´æ–°]
    J --> K[å‰ç«¯åŒæ­¥çŠ¶æ€]
```

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### 1. æœ¬åœ°å¼€å‘ç¯å¢ƒæ­å»º

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd v0-sandbox

# å®‰è£…ä¾èµ–
npm install

# é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env.local
# ç¼–è¾‘ .env.local å¡«å…¥ Dify API é…ç½®

# åˆå§‹åŒ–æ•°æ®åº“
npx prisma generate
npx prisma db push

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

### 2. Docker å¼€å‘ç¯å¢ƒ

```bash
# ä½¿ç”¨ Docker Compose
docker-compose up

# æˆ–å•ç‹¬æ„å»º
docker build -t v0-sandbox .
docker run -p 3000:3000 v0-sandbox
```

### 3. æ–°å¢ AI åŠŸèƒ½

```typescript
// 1. åˆ›å»ºæ–°çš„ AI å®¢æˆ·ç«¯
class CustomAIClient {
  async generateCode(prompt: string): Promise<GenerateResult> {
    // å®ç°ä»£ç ç”Ÿæˆé€»è¾‘
  }
}

// 2. åœ¨ AI è·¯ç”±ä¸­é›†æˆ
// src/app/api/ai/custom/route.ts
export async function POST(request: Request) {
  const client = new CustomAIClient();
  const result = await client.generateCode(prompt);
  return NextResponse.json(result);
}

// 3. å‰ç«¯ç»„ä»¶è°ƒç”¨
const handleGenerate = async () => {
  const response = await fetch("/api/ai/custom", {
    method: "POST",
    body: JSON.stringify({ prompt }),
  });
};
```

### 4. æ‰©å±•æ–‡ä»¶ç±»å‹æ”¯æŒ

```typescript
// åœ¨ Monaco é…ç½®ä¸­æ·»åŠ æ–°è¯­è¨€
// src/lib/monaco-config.ts
export class MonacoConfig {
  static configureLanguage(monaco: Monaco, language: string) {
    switch (language) {
      case "vue":
        monaco.languages.register({ id: "vue" });
        // é…ç½® Vue è¯­æ³•é«˜äº®
        break;
      case "svelte":
        monaco.languages.register({ id: "svelte" });
        // é…ç½® Svelte è¯­æ³•é«˜äº®
        break;
    }
  }
}
```

## ğŸ”§ éƒ¨ç½²æŒ‡å—

### 1. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

```bash
# æ„å»ºé¡¹ç›®
npm run build

# å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
npm start

# æˆ–ä½¿ç”¨ PM2
pm2 start npm --name "v0-sandbox" -- start
```

### 2. Docker éƒ¨ç½²

```dockerfile
# ç”Ÿäº§ Dockerfile
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY . .
RUN npm run build
EXPOSE 3000
CMD ["npm", "start"]
```

### 3. ç¯å¢ƒå˜é‡é…ç½®

```bash
# ç”Ÿäº§ç¯å¢ƒå˜é‡
NODE_ENV=production
NEXT_PUBLIC_BASE_URL=https://your-domain.com
DIFY_API_ENDPOINT=https://your-dify-api.com
DATABASE_URL=postgresql://user:pass@host:5432/db
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### 1. å‰ç«¯ä¼˜åŒ–

- **ä»£ç åˆ†å‰²**: ä½¿ç”¨ Next.js åŠ¨æ€å¯¼å…¥
- **å›¾ç‰‡ä¼˜åŒ–**: Next.js Image ç»„ä»¶
- **ç¼“å­˜ç­–ç•¥**: SWR æ•°æ®è·å–
- **Bundle åˆ†æ**: webpack-bundle-analyzer

### 2. åç«¯ä¼˜åŒ–

- **æ•°æ®åº“ç´¢å¼•**: Prisma æŸ¥è¯¢ä¼˜åŒ–
- **API ç¼“å­˜**: Redis ç¼“å­˜å±‚
- **æ–‡ä»¶ç³»ç»Ÿ**: å†…å­˜æ–‡ä»¶ç³»ç»Ÿé€‰é¡¹
- **WebSocket**: è¿æ¥æ± ç®¡ç†

### 3. Docker ä¼˜åŒ–

- **å¤šé˜¶æ®µæ„å»º**: å‡å°é•œåƒå¤§å°
- **èµ„æºé™åˆ¶**: CPU å’Œå†…å­˜çº¦æŸ
- **å¥åº·æ£€æŸ¥**: å®¹å™¨çŠ¶æ€ç›‘æ§
- **æ—¥å¿—ç®¡ç†**: ç»“æ„åŒ–æ—¥å¿—è¾“å‡º

## ğŸ”’ å®‰å…¨è€ƒè™‘

### 1. ä»£ç æ‰§è¡Œå®‰å…¨

- **æ²™ç®±éš”ç¦»**: Docker å®¹å™¨éš”ç¦»
- **èµ„æºé™åˆ¶**: CPUã€å†…å­˜ã€ç½‘ç»œé™åˆ¶
- **æ–‡ä»¶ç³»ç»Ÿ**: åªè¯»æ ¹æ–‡ä»¶ç³»ç»Ÿ
- **ç”¨æˆ·æƒé™**: é root ç”¨æˆ·è¿è¡Œ

### 2. API å®‰å…¨

- **è¾“å…¥éªŒè¯**: ä¸¥æ ¼çš„å‚æ•°æ ¡éªŒ
- **Rate Limiting**: API è°ƒç”¨é¢‘ç‡é™åˆ¶
- **CORS é…ç½®**: è·¨åŸŸè¯·æ±‚æ§åˆ¶
- **è®¤è¯æˆæƒ**: JWT æˆ– Session ç®¡ç†

### 3. æ•°æ®å®‰å…¨

- **SQL æ³¨å…¥**: Prisma ORM é˜²æŠ¤
- **XSS é˜²æŠ¤**: è¾“å…¥è¾“å‡ºè½¬ä¹‰
- **CSRF ä¿æŠ¤**: Token éªŒè¯
- **æ•æ„Ÿä¿¡æ¯**: ç¯å¢ƒå˜é‡ç®¡ç†

## ğŸ› æ•…éšœæ’é™¤

### 1. å¸¸è§é—®é¢˜

#### Docker ç›¸å…³

```bash
# Docker æœåŠ¡æœªå¯åŠ¨
sudo systemctl start docker

# æƒé™é—®é¢˜
sudo usermod -aG docker $USER

# å®¹å™¨ç«¯å£å†²çª
docker ps -a
docker stop <container-id>
```

#### AI ç”Ÿæˆå¤±è´¥

```bash
# æ£€æŸ¥ Dify API é…ç½®
curl -X POST $DIFY_API_ENDPOINT \
  -H "Authorization: Bearer $DIFY_API_KEY" \
  -d '{"inputs": {"query": "test"}}'

# æŸ¥çœ‹è¯¦ç»†é”™è¯¯æ—¥å¿—
tail -f /var/log/v0-sandbox.log
```

#### é¡¹ç›®å¯åŠ¨å¤±è´¥

```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tulpn | grep :3000

# æ¸…ç† node_modules
rm -rf sandbox/node_modules
cd sandbox && npm install

# é‡ç½® sandbox
curl -X POST localhost:3000/api/sandbox/reset \
  -H "Content-Type: application/json" \
  -d '{"confirmReset": true}'
```

### 2. æ—¥å¿—åˆ†æ

```bash
# åº”ç”¨æ—¥å¿—
docker logs v0-sandbox

# ç³»ç»Ÿèµ„æº
docker stats

# ç£ç›˜ä½¿ç”¨
df -h
du -sh sandbox/
```

## ğŸ“š æ‰©å±•èµ„æº

### 1. ç›¸å…³æ–‡æ¡£

- [Next.js å®˜æ–¹æ–‡æ¡£](https://nextjs.org/docs)
- [Monaco Editor API](https://microsoft.github.io/monaco-editor/api/)
- [Docker å®˜æ–¹æ–‡æ¡£](https://docs.docker.com/)
- [Prisma æ–‡æ¡£](https://www.prisma.io/docs)

### 2. ç¤¾åŒºèµ„æº

- [Dify ç¤¾åŒº](https://github.com/langgenius/dify)
- [shadcn/ui ç»„ä»¶åº“](https://ui.shadcn.com/)
- [Tailwind CSS](https://tailwindcss.com/docs)

### 3. å¼€å‘å·¥å…·

- [VS Code Prisma æ‰©å±•](https://marketplace.visualstudio.com/items?itemName=Prisma.prisma)
- [Docker Desktop](https://www.docker.com/products/docker-desktop)
- [Postman API æµ‹è¯•](https://www.postman.com/)

## ğŸ¯ æœªæ¥è§„åˆ’

### 1. åŠŸèƒ½æ‰©å±•

- [ ] æ”¯æŒæ›´å¤šå‰ç«¯æ¡†æ¶ (Vue.js, Svelte)
- [ ] é›†æˆæ›´å¤š AI æ¨¡å‹ (OpenAI, Claude)
- [ ] å¤šç”¨æˆ·åä½œç¼–è¾‘
- [ ] ç‰ˆæœ¬æ§åˆ¶é›†æˆ (Git)
- [ ] é¡¹ç›®æ¨¡æ¿å¸‚åœº

### 2. æ€§èƒ½æå‡

- [ ] æœåŠ¡ç«¯æ¸²æŸ“ä¼˜åŒ–
- [ ] è¾¹ç¼˜è®¡ç®—éƒ¨ç½²
- [ ] æ™ºèƒ½ç¼“å­˜ç­–ç•¥
- [ ] å¢é‡æ„å»ºæ”¯æŒ

### 3. å¼€å‘ä½“éªŒ

- [ ] å¯è§†åŒ–é¡¹ç›®é…ç½®
- [ ] æ™ºèƒ½é”™è¯¯è¯Šæ–­
- [ ] æ€§èƒ½ç›‘æ§ä»ªè¡¨æ¿
- [ ] æ’ä»¶ç³»ç»Ÿæ¶æ„

---

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- é¡¹ç›®ä»“åº“: [GitHub Issues](https://github.com/your-repo/v0-sandbox/issues)
- æ–‡æ¡£æ›´æ–°: 2024 å¹´ 12 æœˆ
- ç‰ˆæœ¬: v1.0.0

**æ„Ÿè°¢ä½¿ç”¨ V0-Sandboxï¼** ğŸš€
